# 微博增强扩展

这是一个用于增强微博网站体验的Chrome扩展项目，提供宽屏显示、深色/浅色模式切换、评论悬浮窗等功能。

## 主要功能

- **宽屏显示**：自动将微博页面宽度扩展，充分利用屏幕空间
- **智能主题系统**：自动跟随系统的深色/浅色模式设置，完美同步微博原生主题切换
- **评论悬浮窗**：查看评论时不离开当前页面，支持主题自动切换
- **背景图片**：支持必应每日图片、自定义图片或渐变背景，随主题智能调节
- **控制面板**：可拖动的控制面板，方便调整设置
- **通知系统**：友好的操作反馈提示
- **缓存清理**：开发调试时自动清理缓存数据，保留用户配置

## 🆕 主题同步增强

### 原生主题切换完美同步
本扩展现在完美支持微博的原生主题切换！当你点击微博页面的主题按钮时：
- ✅ 扩展的所有功能都会立即跟随切换
- ✅ 背景图片自动调整透明度和颜色
- ✅ 评论悬浮窗实时更新主题
- ✅ 扩展界面同步切换深色/浅色模式

### 调试工具
提供强大的调试功能，在控制台输入：
```javascript
// 测试主题同步功能
testNativeThemeSync()

// 查看监听器状态
debugNativeThemeSwitch()

// 重新初始化主题系统
reinitializeThemeSystem()
```

详细说明请查看 [主题同步修复文档](./THEME_SYNC_FIX.md)

## 开发特性

### 自动缓存清理
为方便开发调试，扩展支持：
- **自动清理**：每次启用/重新加载扩展时自动清理缓存
- **手动清理**：通过设置面板手动清理缓存数据
- **配置保留**：清理时保留所有用户配置设置
- **开发友好**：避免缓存干扰，确保测试环境干净

详细使用说明请查看 [缓存清理功能指南](./CACHE_CLEAR_GUIDE.md)

## 目录结构

```
weibo-pro/
├── src/                   # 源代码目录
│   ├── modules/          # 功能模块
│   │   ├── comments.js   # 评论功能模块
│   │   ├── theme.js      # 主题系统模块
│   │   ├── ui.js         # UI控制面板模块
│   │   └── widescreen.js # 宽屏功能模块
│   ├── styles/           # 样式文件
│   │   ├── comments.js   # 评论系统样式
│   │   ├── controlPanel.js # 控制面板样式
│   │   └── widescreen.js # 宽屏模式样式
│   └── utils/            # 工具函数
│       ├── background-image.js # 背景图片处理
│       ├── chrome-storage.js   # Chrome存储API封装
│       └── notification.js     # 通知系统
├── icons/                # 扩展图标
├── background.js         # 后台脚本
├── content.js           # 内容脚本
├── popup.html           # 弹出页面
├── popup.js             # 弹出页面脚本
├── manifest.json        # 扩展清单文件
└── README.md            # 项目说明
```

## 开发指南

### 功能模块说明

- **widescreen.js**：实现微博页面宽屏显示功能，支持新旧版微博
- **theme.js**：实现主题系统，能够自动适应系统的深色/浅色模式
- **comments.js**：实现评论悬浮窗功能，让用户不需要跳转页面即可查看评论
- **ui.js**：实现控制面板，让用户可以方便地调整各项设置

### 开发流程

这是一个Chrome扩展项目，开发流程如下：

1. 修改源代码文件
2. 在Chrome浏览器中访问 `chrome://extensions/`
3. 开启开发者模式
4. 点击"重新加载"按钮或重新加载扩展
5. 测试功能是否正常

### 自定义开发

如需添加新功能或修改现有功能：

1. 在 `src/modules/` 目录下创建新的功能模块文件
2. 在 `content.js` 中导入并初始化该模块
3. 重新加载扩展进行测试

## 安装指南

### 浏览器要求

支持Chrome扩展的现代浏览器，包括但不限于：

- Google Chrome
- Microsoft Edge
- 其他基于Chromium的浏览器

### 安装步骤

1. 下载或克隆此项目到本地
2. 打开Chrome浏览器，访问 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择项目根目录（包含manifest.json的文件夹）
6. 扩展将自动安装并启用

## 使用方法

1. 安装后扩展会自动启用各项功能
2. 通过扩展图标或页面控制面板调整设置：
   - 点击浏览器工具栏中的扩展图标打开设置面板
   - 或者在微博页面右上角找到控制面板图标
   - 可以设置是否启用宽屏、更宽模式、切换主题等

3. 快捷键：
   - `Ctrl+Shift+R`：重置主题为跟随系统模式
   - `Ctrl+Shift+D`：开发者模式（分析评论元素）

## 贡献指南

欢迎贡献代码或提交问题！请遵循以下步骤：

1. Fork 此仓库
2. 创建功能分支 (`git checkout -b feature/amazing-feature`)
3. 提交更改 (`git commit -m 'Add amazing feature'`)
4. 推送到分支 (`git push origin feature/amazing-feature`)
5. 开启一个 Pull Request

## 许可证

MIT License - 详见 [LICENSE](LICENSE) 文件
